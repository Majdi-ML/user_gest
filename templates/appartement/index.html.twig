{% extends 'base.html.twig' %}

{% block title %}Appartement index{% endblock %}

{% block body %}
<div class="container mt-4">
    <h1 class="mb-4">üè† Liste des Appartements</h1>

<div class="mb-3 text-end">
    <a href="{{ path('app_appartement_new') }}" class="btn btn-success">
        ‚ûï Ajouter un Appartement
    </a>
</div>

    <!-- Formulaire de filtrage -->
    <form method="get">
        <div class="form-group">
            <label for="bloc">Bloc</label>
            <select name="bloc" id="bloc" class="form-control">
                <option value="">S√©lectionner un bloc</option>
                {% for bloc in blocs %}
                    <option value="{{ bloc.nom }}" {% if bloc.nom == blocFilter %}selected{% endif %}>{{ bloc.nom }}</option>

                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="etage">√âtage</label>
            <select name="etage" id="etage" class="form-control">
                <option value="">S√©lectionner un √©tage</option>
                {% for etage in etages %}
<option value="{{ etage.etage }}" {% if etage.etage == etageFilter %}selected{% endif %}>{{ etage.etage }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="locataire">Locataire</label>
            <select name="locataire" id="locataire" class="form-control">
                <option value="">S√©lectionner un locataire</option>
                {% for locataire in locataires %}
                    <option value="{{ locataire.id }}" {% if locataire.id == locataireFilter %}selected{% endif %}>
                        {{ locataire.nom }} {{ locataire.prenom }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="proprietaire">Propri√©taire</label>
            <select name="proprietaire" id="proprietaire" class="form-control">
                <option value="">S√©lectionner un propri√©taire</option>
                {% for proprietaire in proprietaires %}
                    <option value="{{ proprietaire.id }}" {% if proprietaire.id == proprietaireFilter %}selected{% endif %}>
                        {{ proprietaire.nom }} {{ proprietaire.prenom }}
                    </option>
                {% endfor %}
            </select>
        </div>

        <button type="submit" class="btn btn-primary mt-3">Appliquer les filtres</button>
    </form>

    <!-- Appartements Lou√©s -->
<h2 class="mt-5 text-success">‚úÖ Appartements Lou√©s</h2>
<table class="table table-bordered table-striped">
    <thead class="table-light">
        <tr>
            <th>ID</th>
            <th>Num√©ro</th>
            <th>Type</th>
            <th>√âtage</th>
            <th>Occup√©</th>
            <th>Locataire</th>
            <th>Propri√©taire</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for appartement in appartementsLoues %}
        <tr>
            <td>{{ appartement.id }}</td>
            <td>{{ appartement.numero }}</td>
            <td>{{ appartement.type }}</td>
            <td>{{ appartement.etage }}</td>
            <td>
                {% if appartement.estHabite %}
                    ‚úÖ Oui
                {% else %}
                    ‚ùå Non
                {% endif %}
            </td>
            <td>
                {% if appartement.locataire %}
                    {{ appartement.locataire.nom }} {{ appartement.locataire.prenom }}
                {% else %}
                    <span class="text-muted">X</span>
                {% endif %}
            </td>
            <td>
                {% if appartement.proprietaire %}
                    {{ appartement.proprietaire.nom }} {{ appartement.proprietaire.prenom }}
                {% else %}
                    <span class="text-muted">X</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ path('app_appartement_show', {'id': appartement.id}) }}" class="btn btn-sm btn-primary">Voir</a>
                <a href="{{ path('app_appartement_edit', {'id': appartement.id}) }}" class="btn btn-sm btn-warning">Modifier</a>
            </td>
        </tr>
    {% else %}
        <tr><td colspan="8">Aucun appartement lou√© trouv√©.</td></tr>
    {% endfor %}
    </tbody>
</table>

<!-- Appartements Non Lou√©s -->
<h2 class="mt-5 text-danger">‚ùå Appartements Non Lou√©s</h2>
<table class="table table-bordered table-striped">
    <thead class="table-light">
        <tr>
            <th>ID</th>
            <th>Num√©ro</th>
            <th>Type</th>
            <th>√âtage</th>
            <th>Occup√©</th>
            <th>Locataire</th>
            <th>Propri√©taire</th>
            <th>Actions</th>
        </tr>
    </thead>
    <tbody>
    {% for appartement in appartementsNonLoues %}
        <tr>
            <td>{{ appartement.id }}</td>
            <td>{{ appartement.numero }}</td>
            <td>{{ appartement.type }}</td>
            <td>{{ appartement.etage }}</td>
            <td>
                {% if appartement.estHabite %}
                    ‚úÖ Oui
                {% else %}
                    ‚ùå Non
                {% endif %}
            </td>
            <td><span class="text-muted">X</span></td>
            <td>
                {% if appartement.proprietaire %}
                    {{ appartement.proprietaire.nom }} {{ appartement.proprietaire.prenom }}
                {% else %}
                    <span class="text-muted">X</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ path('app_appartement_show', {'id': appartement.id}) }}" class="btn btn-sm btn-primary">Voir</a>
                <a href="{{ path('app_appartement_edit', {'id': appartement.id}) }}" class="btn btn-sm btn-warning">Modifier</a>
            </td>
        </tr>
    {% else %}
        <tr><td colspan="8">Aucun appartement non lou√© trouv√©.</td></tr>
    {% endfor %}
    </tbody>
</table>

</div>
{% endblock %}
